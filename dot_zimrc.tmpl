{{- if ne .chezmoi.os "windows" }}
# Zim framework module configuration
# This file defines Zim modules to load
# Note: This file is not sourced at Zsh startup, only used for zimfw plugin manager

# zsh-defer module - must be loaded first for deferred execution support
zmodule romkatv/zsh-defer

# Core modules - basic Zsh environment configuration
zmodule environment
zmodule input

zmodule git
{{- if not (and (hasKey . "features") .features.enable_starship) }}
# Use Zim built-in prompt modules if Starship is not enabled
zmodule duration-info
zmodule git-info
zmodule asciiship
{{- end }}

{{- if and (hasKey . "features") .features.enable_fzf }}
# fzf integration handled by custom config, not using Zim module (defer supported)
# fzf initialization is handled in fzf-config.sh
{{- end }}

# Completion system configuration - deferred loading for faster startup
# Completion system initialization is handled in shell-common.sh via zsh-defer
zmodule zsh-users/zsh-completions --fpath src
# The completion module is deferred in shell-common.sh, commented out here to avoid duplication
# zmodule completion

# The following modules must be loaded last for correct functionality
# Syntax highlighting module - deferred loading for faster startup
# Syntax highlighting initialization is handled in shell-common.sh via zsh-defer
# zmodule zsh-users/zsh-syntax-highlighting
# Autosuggestions module
zmodule zsh-users/zsh-autosuggestions
# History substring search - supports prefix search in history
zmodule zsh-users/zsh-history-substring-search
{{- end }}