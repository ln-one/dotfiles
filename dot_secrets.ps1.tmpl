{{- if and (eq .chezmoi.os "windows") .features.enable_1password (lookPath "op") -}}
# ========================================
# 1Password Secret References for Windows PowerShell
# This file is managed by chezmoi and uses 1Password CLI
# ========================================

# Git configuration secrets
$env:GIT_USER_EMAIL = "{{ .secrets.git_user_email }}"
$env:GIT_SIGNING_KEY = "{{ .secrets.git_signing_key }}"

# API Keys
$env:OPENAI_API_KEY = "{{ .secrets.openai_api_key }}"

# Google Cloud
$env:GOOGLE_CLOUD_PROJECT = "{{ .secrets.google_cloud_project }}"

# Aliyun Server credentials
$env:ALIYUN_SERVER_URL = "{{ .secrets.aliyun_server_url }}"
$env:ALIYUN_SERVER_USERNAME = "{{ .secrets.aliyun_server_username }}"

# Database credentials
$env:DB_USER = "{{ .secrets.db_user }}"
$env:DB_PASS = "{{ .secrets.db_pass }}"
$env:DB_HOST = "{{ .secrets.db_host }}"
$env:DB_PORT = "{{ .secrets.db_port }}"


{{- else -}}
# ========================================
# Fallback Environment Variables for Windows PowerShell
# 1Password CLI not available, using fallback values
# ========================================

# Git configuration (fallback)
$env:GIT_USER_EMAIL = "{{ .user.email }}"
$env:GIT_SIGNING_KEY = ""

Write-Host "Using fallback configuration (1Password not available)" -ForegroundColor Yellow
{{- end -}}